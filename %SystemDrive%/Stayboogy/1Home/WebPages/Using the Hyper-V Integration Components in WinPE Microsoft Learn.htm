<!DOCTYPE html>
<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-dark" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none" lang="en-us"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="Using the Hyper-V Integration Components in WinPE">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://learn.microsoft.com/en-us/archive/blogs/mikester/using-the-hyper-v-integration-components-in-winpe">

	<meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png">

	<meta property="og:image:alt" content="Microsoft Learn">

	<meta name="twitter:card" content="summary_large_image">

	<meta name="twitter:site" content="@MicrosoftLearn">

	<meta name="color-scheme" content="light dark">


	<meta name="archived_blog_id" content="82803">
<meta name="archived_blog_orig_url" content="https://blogs.msdn.microsoft.com/mikester">
<meta name="archived_blog_post_author" content="Mike Sterling [MSFT]">
<meta name="archived_blog_post_author_email" content="mike.sterling@microsoft.com">
<meta name="archived_blog_post_id" content="53">
<meta name="author" content="kexugit">
<meta name="breadcrumb_path" content="/archive/blogs/bread/toc.json">
<meta name="depot_name" content="MSDN.blogs-archive">
<meta name="document_id" content="50fb6007-92bb-5547-aa45-f217b89b821d">
<meta name="document_version_independent_id" content="b093606c-9eec-e632-bdc1-1eb7ca1edc58">
<meta name="feedback_system" content="None">
<meta name="git_commit_id" content="68b4974f8bb64f609380110e145b13d92e813363">
<meta name="gitcommit" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/blogs-archive-pr/commit/68b4974f8bb64f609380110e145b13d92e813363?path=/blogs-archive/mikester/using-the-hyper-v-integration-components-in-winpe.md&amp;_a=contents">
<meta name="is_archived" content="true">
<meta name="locale" content="en-us">
<meta name="ms.author" content="Archiveddocs">
<meta name="ms.date" content="05/30/2008">
<meta name="ms.topic" content="Archived">
<meta name="original_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/blogs-archive-pr?path=/blogs-archive/mikester/using-the-hyper-v-integration-components-in-winpe.md&amp;version=GBlive&amp;_a=contents">
<meta name="page_type" content="conceptual">
<meta name="ROBOTS" content="NOINDEX,NOFOLLOW">
<meta name="schema" content="Conceptual">
<meta name="site_name" content="Docs">
<meta name="toc_rel" content="toc.json">
<meta name="uhfHeaderId" content="MSDocsHeader-Archive">
<meta name="updated_at" content="2021-08-06 04:24 AM">
<meta name="word_count" content="586">


	<meta name="recommendation_types" content="Training">
	<meta name="recommendation_types" content="Certification">
	

	<meta name="persistent_id" content="5b79ce57-7929-e274-6bee-a569afec351c">
	



	<meta name="scope" content="Blogs">
	<meta name="github_feedback_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/blogs-archive-pr?path=/blogs-archive/mikester/using-the-hyper-v-integration-components-in-winpe.md&amp;version=GBlive&amp;_a=contents">
<link href="https://learn.microsoft.com/en-us/archive/blogs/mikester/using-the-hyper-v-integration-components-in-winpe" rel="canonical">
	<title>Using the Hyper-V Integration Components in WinPE | Microsoft Learn</title>

		<link rel="stylesheet" href="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/44daae31.css">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {
			},
			hasBinaryRating: false,
			hasGithubIssues: false,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			contentWellNotification: '',
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			extendBreadcrumb: false,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,
			hasRecommendations: true,
		},
		functions:{}
	};
	</script>
	<script src="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/wcp-consent.js"></script>
	<script src="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/ms.js"></script>

	<script src="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/67a45209.js"></script>
		<link rel="preconnect" href="https://mscom.demdex.net/" crossorigin="">
		<link rel="dns-prefetch" href="https://target.microsoft.com/">
		<link rel="dns-prefetch" href="https://microsoftmscompoc.tt.omtrdc.net/">
		<link rel="preload" as="script" href="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/at.js" integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu" crossorigin="anonymous" id="adobe-target-script" type="application/javascript">
		<script src="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/331a0985.js"></script><style></style>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"name":"Learn","position":1,"@type":"ListItem","item":"https://learn.microsoft.com/en-us/"},{"name":"Blog Archive","position":2,"@type":"ListItem","item":"https://learn.microsoft.com/en-us/archive/blogs/"},{"name":"Mike's Blog, or how I learned to love the virtual machine...","position":3,"@type":"ListItem","item":"https://learn.microsoft.com/en-us/archive/blogs/mikester"}]}</script></head>

<body dir="ltr" lang="en-us">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div id="cookie-consent-holder" data-test-id="cookie-consent-container" hidden=""></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;" hidden="">
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881" style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge" style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info about Internet Explorer and Microsoft Edge					</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<div id="ms--site-header" class="uhf-container has-padding display-none"></div>

		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization"><!----> <div class="nav-bar" data-test-id="primary-nav-bar" data-bi-name="L1-header"><!----> <div class="nav-bar-brand display-flex align-items-center padding-none margin-left-xs margin-left-none-tablet margin-right-xxs">
		
					<a class="nav-bar-button padding-inline-none" itemprop="url" href="https://www.microsoft.com/" aria-label="Microsoft" data-bi-name="microsoft-logo-link">
						 <div class="nav-bar-logo" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope">
				
		<svg xmlns="http://www.w3.org/2000/svg" width="108" height="23" viewBox="72 72 337 74" preserveAspectRatio="xMidYMin slice">
			<g data-name="MS-symbol">
				<clipPath>
					<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z"></path>
				</clipPath>
				<g clip-path="url(#a)">
					<path d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z" class="fill-current-color fill-link-text-forced-colors color-text-subtle"></path>
					<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022"></path>
					<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00"></path>
					<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef"></path>
					<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900"></path>
				</g>
			</g>
		</svg>
	
		  </div>
					</a>
			  
	</div> 
				
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button class="nav-bar-button is-title" data-test-id="mobile-nav-expander" title="Global navigation" aria-expanded="false">
					<span class="nav-bar-menu-title"><!---->Documentation<!----></span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label"><!---->Global navigation<!----></span>
					</div>
				</button>
			</div>
		</div>
	
				
		<nav class="nav-bar-nav" role="navigation" aria-label="Global">
			<ul class="nav-bar-nav-list">
				
		<li class="nav-bar-item is-category">
			<a data-test-id="header-link-category" class="nav-bar-button is-title has-hover-underline" itemprop="url" data-bi-name="L1-category-link" href="https://learn.microsoft.com/en-us/">
				<span><!---->Learn<!----></span>
			</a>
		</li>
	
				<!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-documentation" class=" nav-bar-button has-hover-underline is-active" href="https://learn.microsoft.com/en-us/docs/" aria-current="true" data-bi-name="L1-navigation-link">
						<span><!---->Documentation<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-training" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/training/" data-bi-name="L1-navigation-link">
						<span><!---->Training<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-credentials" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/credentials/" data-bi-name="L1-navigation-link">
						<span><!---->Credentials<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-q&amp;a" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/answers/" data-bi-name="L1-navigation-link">
						<span><!---->Q&amp;A<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-code-samples" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/samples/browse/" data-bi-name="L1-navigation-link">
						<span><!---->Code Samples<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-assessments" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/assessments/" data-bi-name="L1-navigation-link">
						<span><!---->Assessments<!----></span>
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a data-test-id="header-link-shows" class=" nav-bar-button has-hover-underline " href="https://learn.microsoft.com/en-us/shows/" data-bi-name="L1-navigation-link">
						<span><!---->Shows<!----></span>
					</a>
				</li>
		  <!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-62" data-bi-name="L1-navigation-menu" value="undefined">
			<span><!---->More<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-62" aria-label="More">
			<!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button is-active" href="https://learn.microsoft.com/en-us/docs/" aria-current="true" data-bi-name="L1-navigation-link">
						Documentation
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/training/" data-bi-name="L1-navigation-link">
						Training
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/credentials/" data-bi-name="L1-navigation-link">
						Credentials
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/answers/" data-bi-name="L1-navigation-link">
						Q&amp;A
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/samples/browse/" data-bi-name="L1-navigation-link">
						Code Samples
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/assessments/" data-bi-name="L1-navigation-link">
						Assessments
					</a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="https://learn.microsoft.com/en-us/shows/" data-bi-name="L1-navigation-link">
						Shows
					</a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
				<span class="nav-bar-spacer"></span>
				
		<div class="nav-bar-search " id="ax-63" hidden="">
			
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form" aria-label="Search" action="/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!---->
			<div class="field-body control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="none" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input" data-test-id="site-search-input" class="autocomplete-input input input-sm
						
						" type="search" name="terms" aria-expanded="false" aria-owns="ax-64-listbox" aria-controls="ax-64-listbox" aria-activedescendant="" aria-label="Search" aria-describedby="ms--site-search-input-description" placeholder="Search previous versions" pattern=".*">

				<span aria-hidden="true" class="icon is-small is-left" hidden="">
					<span class="has-text-primary docon docon-"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span id="ms--site-search-input-description" hidden="">
					Suggestions will filter as you type
				</span>
			</div>

			<ul role="listbox" id="ax-64-listbox" data-test-id="site-search-input-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="Suggestions" hidden="">
				
				
			</ul>
		<!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="">
			<input name="dataSource" value="previousVersions" hidden="">
			
		</form>
	
		</div>
		
					<div class="nav-bar-search">
						<!-- hidden when the width drops to tablet -->
						
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form-desktop" aria-label="Search" action="/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!---->
			<div class="field-body control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="none" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input-desktop" data-test-id="site-search-input-desktop" class="autocomplete-input input input-sm
						control has-icons-left
						" type="search" name="terms" aria-expanded="false" aria-owns="ax-65-listbox" aria-controls="ax-65-listbox" aria-activedescendant="" aria-label="Search" aria-describedby="ms--site-search-input-desktop-description" placeholder="Search previous versions" pattern=".*">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-search"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span id="ms--site-search-input-desktop-description" hidden="">
					Suggestions will filter as you type
				</span>
			</div>

			<ul role="listbox" id="ax-65-listbox" data-test-id="site-search-input-desktop-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="Suggestions" hidden="">
				
				
			</ul>
		<!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="">
			<input name="dataSource" value="previousVersions" hidden="">
			
		</form>
	
					</div>
			  
		<div class="nav-bar-search " hidden="">
			<div class="nav-bar-search-form-expander">
				<button id="form-expander" data-test-id="form-expander" class="nav-bar-button has-hover-underline " title="Search" aria-expanded="false" aria-controls="ax-63">
					
		<span class="is-visually-hidden-mobile"><!---->Search<!----></span>
		<span class="icon margin-left-xxs" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	
				</button>
			</div>
		</div>
	
				
		<div class="nav-bar-profile">
			
		<a class="docs-sign-in auth-status-determined not-authenticated" href="#"> Sign in </a>
	 
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button class="dropdown-trigger button-reset" aria-controls="user-menu" aria-expanded="false" data-bi-name="L1-user-menu" aria-label="Your Account">
				<figure class="image is-36x36">
					<img class="has-body-background-medium border-radius-rounded" alt="" data-profile-property="avatarThumbnailUrl">
				</figure>
			</button>
			<div class="dropdown-menu box justify-content-flex-start has-body-background" id="user-menu" data-bi-name="user-menu" role="menu">
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img class="has-body-background-medium border-radius-rounded" aria-labelledby="displayName" alt="" data-profile-property="avatarUrl">
						</figure>
					</div>
					<div class="media-content">
						<h2 class="title font-size-lg">
							<span id="displayName" class="is-inline-truncated has-max-width-200" data-profile-property="displayName"></span>
						</h2>
						<p class="subtitle font-size-sm margin-bottom-none">
							<span class="is-inline-truncated has-max-width-200" data-profile-property="upn"></span>
						</p>
					</div>
				</div>
				<ul class="padding-top-xs padding-bottom-xs">
					<li class="padding-bottom-xs">
						<a data-profile-property="profileUrl" href="https://learn.microsoft.com/en-us/users/me/activity/"><!---->Profile<!----></a>
					</li>
					<li>
						<a data-profile-property="settingsUrl" href="https://learn.microsoft.com/en-us/users/me/settings/"><!---->Settings<!----></a>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out" href="#"><!---->Sign out<!----></a>
				</div>
			</div>
		</div>
	
		</div>
	
			 <!----></div>  <!----></header>		</div>


			<div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button="">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">
Table of contents						</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div>

		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"><!---->
			<section data-dismissable="disappearing" data-bi-name="banner" class="is-info alert is-banner">
				<div class="uhf-container">
					<button data-dismiss="" data-bi-name="close" type="button" class="delete position-absolute top-0 right-0 margin-xxs delete-lg">
						<span class="visually-hidden"><!---->Dismiss alert<!----></span>
					</button>
					<div class="columns">
						<div class="column is-12">
							<div class="level justify-content-flex-start">
								<div class="level-left flex-shrink-1">
									<div class="level-item flex-shrink-1">
										<p class="has-text-white-static disclaimer-title margin-top-xxs margin-right-xs has-line-height-reset">
											<span class="icon">
												<span class="docon docon-status-error-outline" aria-hidden="true"></span>
											</span>
											<span><!---->We're no longer updating this content regularly. Check the <a href="https://learn.microsoft.com/en-us/lifecycle/products">Microsoft Product Lifecycle</a> for information about how this product, service, technology, or API is supported.<!----></span>
										</p>
									</div>
								</div>
								 <div class="level-right margin-xxs margin-none-tablet">
				<div class="level-item justify-content-flex-start padding-xxs-tablet">
					
					<a data-bi-name="CTA" href="https://learn.microsoft.com/" class="button button-info button-sm margin-inline-xxs">
						<span><!---->Return to main site<!----></span>
					</a>
			  
				</div>
		  </div>
							</div>
						</div>
					</div>
				</div>
			</section>
		<!----></div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" role="navigation" aria-label="Primary" style="top: 24px; height: calc(-49px + 100vh); max-height: 5177.5px;" data-bi-name="left toc"><form action="javascript:" role="search" aria-label="Search" class="margin-bottom-xxs"><label class="visually-hidden" for="ax-40">Search</label><div class="autocomplete display-block" data-bi-name="autocomplete"><!---->
			<div class="field-body control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="none" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-40" data-test-id="ax-40" class="autocomplete-input input input-sm
						control has-icons-left
						width-full" type="text" aria-expanded="false" aria-owns="ax-41-listbox" aria-controls="ax-41-listbox" aria-activedescendant="" aria-describedby="ms--ax-40-description" placeholder="Filter by title" pattern=".*">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-filter-settings"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>

				<span id="ms--ax-40-description" hidden="">
					Suggestions will filter as you type
				</span>
			</div>

			<ul role="listbox" id="ax-41-listbox" data-test-id="ax-40-listbox" class="autocomplete-suggestions is-vertically-scrollable padding-xxs " aria-label="Suggestions" hidden="">
				
				
			</ul>
		<!----></div></form><ul class="tree table-of-contents is-vertically-scrollable flex-grow-1 flex-shrink-1" role="tree" aria-label="Table of contents" data-bi-name="tree" data-is-collapsible="true"><li class="tree-item is-expanded" aria-setsize="1" aria-level="1" aria-posinset="1" role="treeitem" tabindex="-1" id="title-1-1" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>2008</span><ul class="tree-group" role="group"><li class="tree-item" aria-setsize="4" aria-level="2" aria-posinset="1" role="treeitem" tabindex="-1" id="title-1-1_1-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>09</span></li><li class="tree-item" aria-setsize="4" aria-level="2" aria-posinset="2" role="treeitem" tabindex="-1" id="title-1-1_2-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>07</span></li><li class="tree-item" aria-setsize="4" aria-level="2" aria-posinset="3" role="treeitem" tabindex="-1" id="title-1-1_3-2" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>06</span></li><li class="tree-item is-expanded" aria-setsize="4" aria-level="2" aria-posinset="4" role="treeitem" tabindex="-1" id="title-1-1_4-2" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>05</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="1" aria-level="3" aria-posinset="1" role="treeitem" tabindex="0" class="tree-item is-leaf has-external-link-indicator is-selected" data-bi-name="tree-leaf" href="https://learn.microsoft.com/en-us/archive/blogs/mikester/using-the-hyper-v-integration-components-in-winpe" aria-current="page">Using the Hyper-V Integration Components in WinPE</a></li></ul></li></ul></li></ul></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" dir="ltr" lang="en-us">
							<!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center ">
									<details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs" hidden="">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"><!---->
			<nav>
				<ol class="list-style-none">
					<!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/en-us/">
										Learn
									</a>
								</li>
							<!----><!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/en-us/archive/blogs/">
										Blog Archive
									</a>
								</li>
							<!----><!---->
								<li class="line-clamp-1">
									<a class="display-block has-inner-focus padding-inline-xs padding-block-xxs border-radius font-size-sm" href="https://learn.microsoft.com/en-us/archive/blogs/mikester">
										Mike's Blog, or how I learned to love the virtual machine...
									</a>
								</li>
							<!---->
				</ol>
			</nav>
			
		<!----></div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs" style="display: block; white-space: nowrap; overflow: hidden;"><!---->
			<nav>
				<ol class="breadcrumbs">
					<!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
									<a href="https://learn.microsoft.com/en-us/"><!---->Learn<!----></a>
								</li>
							<!----><!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="">
									<a href="https://learn.microsoft.com/en-us/archive/blogs/"><!---->Blog Archive<!----></a>
								</li>
							<!----><!---->
								<li class="breadcrumbs-item" data-bread-crumbs-collapse-target="" style="">
									<a href="https://learn.microsoft.com/en-us/archive/blogs/mikester" style=""><!---->Mike's Blog, or how I learned to love the virtual machine...<!----></a>
								</li>
							<!---->
				</ol>
			</nav>
		<!----></bread-crumbs>

									<div id="article-header-page-actions" class="margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch">

										<a id="lang-link-tablet" class="button button-primary button-clear button-sm display-none display-inline-flex-tablet" title="Read in English" data-bi-name="language-toggle" data-read-in-link="" href="https://learn.microsoft.com/en-us/archive/blogs/mikester/using-the-hyper-v-integration-components-in-winpe" data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}" hidden="">
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon="">
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text="">Read in English</span>
										</a>

											<button type="button" class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet" data-list-type="collection" data-bi-name="collection" title="Add Using the Hyper-V Integration Components in WinPE | Microsoft Learn to a collection" data-pressed="false">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Add</span>
											</button>
										

										


										
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-none">
													<button data-page-action-item="overflow-mobile" type="button" class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet" data-bi-name="contents-expand" data-contents-button="" data-popover-close="">
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span>
															<span class="contents-expand-title">Table of contents</span>
													</button>

												<a id="lang-link-overflow" class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet" title="Read in English" data-bi-name="language-toggle" data-page-action-item="overflow-mobile" data-check-hidden="true" data-read-in-link="" href="https://learn.microsoft.com/en-us/archive/blogs/mikester/using-the-hyper-v-integration-components-in-winpe" data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}" hidden="">
													<span class="icon" aria-hidden="true" data-read-in-link-icon="">
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text="">Read in English</span>
												</a>

													<button type="button" class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet" data-list-type="collection" data-bi-name="collection" title="Add Using the Hyper-V Integration Components in WinPE | Microsoft Learn to a collection" data-page-action-item="overflow-mobile" data-check-hidden="true" data-popover-close="" data-pressed="false">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Add</span>
													</button>


													<button class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus" title="Print" type="button" aria-label="Print" data-bi-name="print" data-page-action-item="overflow-all" data-popover-close="" data-print-page="" data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print"></span>
														</span>
														<span>Print</span>
													</button>

													<div aria-hidden="true" class="margin-none
														border-top" data-page-action-item="overflow-all"></div>

													
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe%3FWT.mc_id%3Dtwitter&amp;text=Today%20I%20completed%20%22Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20%7C%20Microsoft%20Learn%22!%20I%27m%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe%3FWT.mc_id%3Dtwitter">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-brand-twitter"></span>
															</span>
															<span>Twitter</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all" href="https://www.linkedin.com/feed/?shareActive=true&amp;text=Today%20I%20completed%20%22Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20%7C%20Microsoft%20Learn%22!%20I%27m%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe%3FWT.mc_id%3Dlinkedin">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-brand-linkedin"></span>
															</span>
															<span>LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe%3FWT.mc_id%3Dfacebook">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-brand-facebook"></span>
															</span>
															<span>Facebook</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-email" data-bi-name="email" data-page-action-item="overflow-all" href="mailto:?subject=%5BShared%20Article%5D%20Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20%7C%20Microsoft%20Learn&amp;body=Today%20I%20completed%20%22Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20%7C%20Microsoft%20Learn%22!%20I'm%20so%20proud%20to%20be%20celebrating%20this%20achievement%20and%20hope%20this%20inspires%20you%20to%20start%20your%20own%20%40MicrosoftLearn%20journey!%0A%0D%0Ahttps%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe%3FWT.mc_id%3Demail">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message-fill"></span>
															</span>
															<span>Email</span>
														</a>
												
											</div>
										</details>
										
									</div>
								</div>
							</div>
							<!-- end article-header -->


							<div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button="" hidden="">
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span>
										<span class="contents-expand-title">Table of contents</span>
								</button>
							</div>

							<!-- end mobile-contents button  -->

							<div class="content ">


								<h1 id="using-the-hyper-v-integration-components-in-winpe">Using the Hyper-V Integration Components in WinPE</h1>


									<div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" dir="ltr" lang="en-us">
													<li>
Article													</li>
													<li>
														<time class="" data-article-date="" aria-label="Article review date" datetime="2008-05-30T00:00:00.000Z" data-article-date-source="ms.date">05/30/2008</time>
													</li>
											</ul>
										</div>
									</div>

									<div id="ms--inline-notifications" data-bi-name="inline-notification"></div>

										<nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" role="navigation" aria-label="In this article" hidden="">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav>

								<!-- <content> -->
									<p>The new architecture of synthetic devices with Hyper-V poses
 some unique challenges for system administrators. Specifically, how can
 a system administrator perform maintenance on a Hyper-V host from 
WinPE? Without the integration components, users are required to move 
their VHD's around to the IDE controller, which limits the amount of 
VHD's that can be used at any given point in time. Additionally, legacy 
network adapters might need to be added to the VM to provide network 
access.</p>
<p>However, by adding the integration components to a WinPE image, those are no longer concerns.</p>
<p>For those of you not familiar with WinPE, here's a brief overview:</p>
<blockquote>
<p><em>Windows Preinstallation Environment (Windows PE) is a minimal 
operating system designed to prepare a computer for Windows 
installation. It can be used to start a computer with no operating 
system (a bare-metal system), to partition and to format hard drives, 
and to copy disk images or to initiate Windows Setup from a network 
share. Windows PE is available as a stand-alone product to customers 
with the proper licensing agreement. It is an integrated component of 
many Windows Setup and recovery technologies, including Setup for 
Windows Vista and Windows Deployment Services (WDS).</em></p>
<p><em>Windows PE 2.1 is the latest release based on the Microsoft® Windows Vista® operating system.</em></p>
</blockquote>
<hr>
<p>Before we start - what I'm about to detail is not supported by Microsoft.These directions are being provided on an AS-IS basis.</p>
<p>Now, on to the steps:</p>
<p>1. Download and install the Windows Automated Installation Kit (AIK).
 This allows you to create a custom WinPE image. The AIK can be 
downloaded here: <a href="https://www.microsoft.com/downloads/details.aspx?FamilyID=94bb6e34-d890-4932-81a5-5b50c657de08&amp;DisplayLang=en" data-linktype="external">https://www.microsoft.com/downloads/details.aspx?FamilyID=94bb6e34-d890-4932-81a5-5b50c657de08&amp;DisplayLang=en</a></p>
<p>2. We need to extract two files from the c:\windows\system32\vmguest.iso file, which is part of Hyper-V RC1 (available at <a href="https://www.microsoft.com/downloads/details.aspx?FamilyId=7EDAA89F-9F64-488D-93C0-858D2D8799DF" data-linktype="external">https://www.microsoft.com/downloads/details.aspx?FamilyId=7EDAA89F-9F64-488D-93C0-858D2D8799DF</a>). There are a couple of tools that allow the mounting of an ISO image:</p>
<p>a. WinImage (<a href="https://www.winimage.com/" data-linktype="external">https://www.winimage.com/</a>)</p>
<p>b. WinISO (<a href="https://www.winiso.com/" data-linktype="external">https://www.winiso.com/</a>)</p>
<p>c. UltraISO (<a href="https://www.ezbsystems.com/ultraiso/" data-linktype="external">https://www.ezbsystems.com/ultraiso/</a>)</p>
<p>You can also mount the ISO image in a VM and extract the files as well.</p>
<p>We’re looking for two files. Copy the file that is appropriate for your architecture:</p>
<p>· 32 Bit: \support\x86\Windows6.0-KB951633-x86.msu</p>
<p>· 64 Bit: \support\amd64\Windows6.0-KB951633-x64.msu</p>
<p>3. Create a directory on the same system you installed the AIK, and store the file(s) above there.</p>
<p>4. Open up the Windows PE User’s Guide. This was installed as part of
 the Windows AIK, and can be found (by default) by browsing to Start 
-&gt; All Programs -&gt; Windows OPK -&gt; Documentation -&gt; Windows 
PE User’s Guide.</p>
<p>5. Follow steps 1-4 under Customizing WinPE -&gt; Windows PE Walkthroughs -&gt; Walkthrough: Create a Custom WinPE Image.</p>
<p>6. After step 4 (Optional: Add Additional Customizations), run the 
following script from your Windows PE Tools Command Prompt. Create a new
 batch file with the script below. <strong>Make sure that the MSUSOURCE 
is set to the directory where the files you copied in step 2 and 3 are, 
and that PESOURCE is set to the directory you created in Step 5.</strong></p>
<p>%echo off</p>
<p>set MSUSOURCE=D:\synth\rc1\amd64</p>
<p>set PESOURCE=D:\winpe_x64_synthetic</p>
<p>mkdir %temp%\IC</p>
<p>c:\windows\system32\expand.exe -F:* %MSUSOURCE%\Windows6.0-KB951633-x64.msu %temp%\ic</p>
<p>mkdir %temp%\IC\binaries</p>
<p>c:\windows\system32\expand.exe -F:* %temp%\ic\Windows6.0-KB951633-x64.CAB %temp%\ic\binaries</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wnetvsc.inf_31bf3856ad364e35_6.0.6001.18010_none_b331f76187e159c6\wnetvsc.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_ws3cap.inf_31bf3856ad364e35_6.0.6001.18010_none_f2dbb8abfcb9f757\ws3cap.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wstorflt.inf_31bf3856ad364e35_6.0.6001.18010_none_1ca7ba32d0b2bd99\wstorflt.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wstorvsc.inf_31bf3856ad364e35_6.0.6001.18010_none_835d97e82051b059\wstorvsc.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wvmbus.inf_31bf3856ad364e35_6.0.6001.18010_none_95947137626ceb80\wvmbus.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wvmbushid.inf_31bf3856ad364e35_6.0.6001.18010_none_4cc9f65464cd2f85\wvmbushid.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wvmbusvideo.inf_31bf3856ad364e35_6.0.6001.18010_none_af4c3664979a87cd\wvmbusvideo.inf
 %PESOURCE%\mount\Windows</p>
<p>"C:\Program Files\Windows OPK\Tools\PETools\peimg.exe" 
/inf=%temp%\IC\binaries\amd64_wvmic.inf_31bf3856ad364e35_6.0.6001.18010_none_5df58a6c04d20690\wvmic.inf
 %PESOURCE%\mount\Windows</p>
<p>Once the batch file completes, refer back to the Windows PE Users Guide, and finish following the steps from Step 5 onward.</p>
<p>After you create the ISO, attach it to a VM and power it on. You should have full access to all synthetic devices.</p>
<p>-Mike</p>

							</div>

							<div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						<div class="user-comments content"><!----><!----><h2><!---->Comments<!----></h2>
		<ul class="margin-none ">
			<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Virtual Varia<!----></div> <time class="display-block" datetime="2008-05-30T08:19:43.000Z"><!---->May 30, 2008<!----></time>
						<div class="comment-body"><!----><p>Mike Sterling just made a triumphant return to blogging by posting an article on how to add the RC1 ICs</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Virtual PC Guy's WebLog<!----></div> <time class="display-block" datetime="2008-05-30T08:55:01.000Z"><!---->May 30, 2008<!----></time>
						<div class="comment-body"><!----><p>Mike Sterling has just done a great post on how to integrate the Hyper-V Integration Services into a</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Anonymous<!----></div> <time class="display-block" datetime="2008-06-01T05:30:14.000Z"><!---->June 1, 2008<!----></time>
						<div class="comment-body"><!---->The comment has been removed<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Firdous Gangat<!----></div> <time class="display-block" datetime="2008-06-01T09:17:59.000Z"><!---->June 1, 2008<!----></time>
						<div class="comment-body"><!----><p>This is great stuff. I'm 
trying to workout if this can be automated into the MDT2008 WinPE ISO 
and WIM process creation process for lab testing</p>
<p>FG</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->mikester<!----></div> <time class="display-block" datetime="2008-06-02T03:38:33.000Z"><!---->June 1, 2008<!----></time>
						<div class="comment-body"><!----><p>@Joseph -</p>
<p>I haven't had a chance to look at BartPE - now that WinPE is 
available to everyone, it's a much better solution (at least in my 
opinion). What does BartPE provide that WinPE doesn't have?</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->mikester<!----></div> <time class="display-block" datetime="2008-06-02T03:40:19.000Z"><!---->June 1, 2008<!----></time>
						<div class="comment-body"><!----><p>@Firdous - </p>
<p>I'm not familliar with the MDT WinPE ISO automated build process - but it might work.</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Mark Emery<!----></div> <time class="display-block" datetime="2008-06-04T12:52:15.000Z"><!---->June 4, 2008<!----></time>
						<div class="comment-body"><!----><p>Doesn't work for me. The PEIMG command always fails with status code 0x80070003.</p>
<p>I'm using PEIMG from AIK not OPK if that matters. I don't get the prompt 'Installing INF package' before the error message. </p>
<p>Other documentation regarding driver injection always refers to image 2 in BOOT.WIM as the proper target.</p>
<p>Any Clues anyone?</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Mark Emery<!----></div> <time class="display-block" datetime="2008-06-04T12:58:12.000Z"><!---->June 4, 2008<!----></time>
						<div class="comment-body"><!----><p>Found status 0x80070003 means INF file wasn't found, path slightly different in x86 kits</p><!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->mikester<!----></div> <time class="display-block" datetime="2008-06-05T12:28:42.000Z"><!---->June 5, 2008<!----></time>
						<div class="comment-body"><!----><p>@Mark: </p>
<p>All the modifications are being made to boot.wim, which gets mounted 
as part of steps 1-4 in the WinPE users guide (Step 5 in my 
instructions).</p>
<p>Can you confirm that the WIM gets mounted, and you can browse the contents?</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Anonymous<!----></div> <time class="display-block" datetime="2008-06-07T15:18:53.000Z"><!---->June 7, 2008<!----></time>
						<div class="comment-body"><!---->The comment has been removed<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Rod Trent at myITforum.com<!----></div> <time class="display-block" datetime="2008-06-12T03:02:26.000Z"><!---->June 11, 2008<!----></time>
						<div class="comment-body"><!----><p>Mike Sterling talks about how to inject Hyper-V into WinPE.&amp;#160; Pretty cool. <a href="http://blogs.msdn.com/">http://blogs.msdn.com</a></p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<a class="font-weight-semibold" href="https://social.msdn.microsoft.com/profile/delfim"><!---->delfim<!----></a> <time class="display-block" datetime="2008-06-18T00:41:54.000Z"><!---->June 17, 2008<!----></time>
						<div class="comment-body"><!----><p>Great information. Just a 
comment, we have to launch the expand command on a Windwos 2008 or maybe
 a vista (not sure) OS. Expanding on a Windows 2003 doesn't produce the 
same files !</p>
<p>Delfim.</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<a class="font-weight-semibold" href="https://social.msdn.microsoft.com/profile/delfim"><!---->delfim<!----></a> <time class="display-block" datetime="2008-06-18T01:02:23.000Z"><!---->June 17, 2008<!----></time>
						<div class="comment-body"><!----><p>I have the following issue with windows 2008 x64 guest and storflt.sys :</p>
<p>Windows cannot verify the digital signature for this file</p>
<p>Is there anybody had this problem ?</p>
<p>Thanks,</p>
<p>Delfim.</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Mike's Blog, or how I learned to love the virtual machine...<!----></div> <time class="display-block" datetime="2008-07-01T16:49:52.000Z"><!---->July 1, 2008<!----></time>
						<div class="comment-body"><!----><p>Now that we've reached the RTM milestone with Hyper-V (and why I'm actually on vacation), here's the</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Hyper-v<!----></div> <time class="display-block" datetime="2008-07-02T01:03:40.000Z"><!---->July 1, 2008<!----></time>
						<div class="comment-body"><!----><p>Mike&amp;#39;s Blog: Now that we&amp;#39;ve reached the RTM milestone with Hyper-V, here&amp;#39;s the updated script</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Mark's Windows Server Blog<!----></div> <time class="display-block" datetime="2008-07-21T20:43:28.000Z"><!---->July 21, 2008<!----></time>
						<div class="comment-body"><!----><p>In the week or so since Hyper-V RTMed there has been a huge amount of coverage on various websites. Here&amp;#39;s</p>
<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->Anonymous<!----></div> <time class="display-block" datetime="2008-10-21T10:22:24.000Z"><!---->October 21, 2008<!----></time>
						<div class="comment-body"><!---->The comment has been removed<!----></div>
						
					</li>
				<!---->
					<li class="padding-block-xxs border-top">
						<div class="display-inline font-weight-semibold"><!---->NoelBlanc<!----></div> <time class="display-block" datetime="2010-02-27T20:54:39.000Z"><!---->February 27, 2010<!----></time>
						<div class="comment-body"><!----><p>hello,</p>
<p>in W2K8R2, i create a vm for winpe3. Drivers for hyperV seems OK. But
 not services hyperV. I The program vmicsvc.exe exist in system32.</p>
<p>I use drvload.exe to install them from the vmguest.iso and the file windows6...</p>
<p>When i launch "net start vmickvpexchange", service starts but stop with error 87 (incorret parameter).</p>
<p>What is wrong for me?</p>
<p>Also, can you speak more about the use of the group "vmickvpexchange".</p>
<p>Thank you very mutch. </p>
<!----></div>
						
					</li>
				<!---->
		</ul><!----></div></main>





						<!-- recommendations section -->
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

							<div id="ms--additional-resources-mobile" role="complementary" aria-label="Additional resources" class="display-none-desktop display-none-print">
								<hr class="hr" hidden="">
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden="">Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden=""></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden=""></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden=""></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden=""></section>
							</div>

						<div class="border-top is-visible-interactive has-default-focus margin-top-sm ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
			<a data-mscc-ic="false" class="locale-selector-link button button-sm button-clear flex-shrink-0" href="https://learn.microsoft.com/en-us/locale?target=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe" data-bi-name="select-locale" aria-label="Content language selector. Currently set to English (United States).">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">English (United States)</span></a>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light margin-right-xxs">
						<span class="theme-selector-icon css-variable-support border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
Light					</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark margin-right-xxs">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
Dark					</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast margin-right-xxs">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>
		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2023</li>
	</ul>
</footer>
						</div>

					</div>

						<div id="ms--additional-resources" class="right-container column is-4-desktop display-none display-block-desktop" data-bi-name="pageactions" role="complementary" aria-label="Additional resources">
							<div id="affixed-right-container" class="margin-top-sm-tablet position-sticky" data-bi-name="right-column" style="top: 36px; bottom: 36px;">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden="">Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden=""></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden=""></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden=""></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="In this article" hidden="">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden=""></section>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
			<a data-mscc-ic="false" class="locale-selector-link button button-sm button-clear flex-shrink-0" href="https://learn.microsoft.com/en-us/locale?target=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Farchive%2Fblogs%2Fmikester%2Fusing-the-hyper-v-integration-components-in-winpe" data-bi-name="select-locale" aria-label="Content language selector. Currently set to English (United States).">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">English (United States)</span></a>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light margin-right-xxs">
						<span class="theme-selector-icon css-variable-support border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
Light					</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark margin-right-xxs">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
Dark					</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast margin-right-xxs">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span>
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>
		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://learn.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2023</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>


<script src="Using%20the%20Hyper-V%20Integration%20Components%20in%20WinPE%20Microsoft%20Learn_files/at.js" async="" defer="defer" integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu" crossorigin="anonymous"></script></body></html>